% Gauss积分点和权重
if NumGLP==5
    lambda=[-0.90617984593866396370032134655048;
            -0.53846931010568310771446931539685;
             0;
             0.5384693101056829966921668528812;
             0.90617984593866418574492627158179];
    weight=[0.23692688505618897387705601431662;
            0.47862867049936630436945961264428;
            0.56888888888888888888888888888889;
            0.47862867049936685948097192522255;
            0.23692688505618919592166093934793;];
end
if NumGLP==7
    lambda=[-0.94910791234275848626822380538215;
            -0.74153118559939457110630200986634;
            -0.40584515137739718415588185962406;
             0;
             0.40584515137739690660012570333492;
             0.74153118559939423803939462231938;
             0.9491079123427583752459213428665];
    weight=[0.12948496616886942534030424667435;
            0.27970539148927708872349739976926;
            0.38183005050511853450956323285936;
            0.41795918367346938775510204081633;
            0.38183005050511853450956323285936;
            0.27970539148927642258968262467533;
            0.12948496616886909227339685912739];
end
if NumGLP==9
    lambda=[-0.96816023950762608585307589237345;
            -0.83603110732663576953882511588745;
            -0.61337143270059057975629457359901;
            -0.32425342340380886030359874894202;
             0;
             0.32425342340380913785935490523116;
             0.61337143270059057975629457359901;
             0.83603110732663565851652265337179;
             0.96816023950762608585307589237345];
    weight=[0.081274388361574523287345073185861;
            0.18064816069485711835795882507227;
            0.2606106964029356043432983369712;
            0.3123470770400031404356866460148;
            0.33023935500125976316452506928697;
            0.31234707704000269634647679595219;
            0.26061069640293504923178602439293;
            0.18064816069485722938026128758793;
            0.081274388361574412265042610670207];
end
% 提前计算基函数
phiG = zeros(k+1,NumGLP,3);
phiGR = zeros(k+1,1);
phiGL = zeros(k+1,1);
mm = zeros(k+1,1);
for i=1:k+1
    for j=1:NumGLP
        phiG(i,j,1)=legend0(i-1,lambda(j));
        phiG(i,j,2)=(2/h)*legend1(i-1,lambda(j));
        phiG(i,j,3)=(2/h)^2*legend2(i-1,lambda(j));
    end
    phiGL(i,1)=legend0(i-1,1);
    phiGL(i,2)=(2/h)*legend1(i-1,1);
    phiGL(i,3)=(2/h)^2*legend2(i-1,1);
    phiGR(i,1)=legend0(i-1,-1);
    phiGR(i,2)=(2/h)*legend1(i-1,-1);
    phiGR(i,3)=(2/h)^2*legend2(i-1,-1);
    mm(i)=1/(1+2*(i-1));
end
MM=h*diag(mm); %局部刚度矩阵